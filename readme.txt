[概要]
Subversionのコミット時にコミットランキング付きのメールを送信するスクリプトです。
多人数で開発している場合にコミット数のランキングがあると燃えるかなと思ってお遊びで作りました。
任意のSMTPを指定したり、GmailのSMTPを指定することもできます。
かなりざっくり作ってあるので汚いですが、少しずつマシにしていく予定です。

[仕様]
・コミット時に登録したメールアドレスへコミットメールを通知します
・コミット時に変更されたファイル数がコミットポイントとして計上されます
・コミットログが未記述の場合はポイントは増えません
・一度のコミットで10ptを超える場合は10ptまでとなります

[ruby]
1.8.7以上で動作確認済み

[gemライブラリ]
tlsmail

[使い方]
setting.rb.default を setting.rb として設定を書いてください
post-commit をリポジトリの hooks/ に置いてください
post-commit に記述されている commit_mail.rb へのパスは環境に合わせて変更してください

Windows環境の場合は、post-commit の代わりに post-commit.cmd をリポジトリの hooks/ に置いてください
post-commit と同じく、commit_mail.rb へのパスは環境に合わせて変更してください

デフォルトではGmailのSMTPを使うように設定してあります。
任意のSMTPを指定したい場合は commit_email.rb の最後辺りを適当にいじってください。
(そのうち良い仕組み考えます)

[飛んで来るメール例]
To: コミッターのみなさま

遅くまでご苦労様です。 Subversion です。

なおきさん(1位)が 1 コミット(1pt)しました。


1: naoki          Today:  2 All:   19    ---
2: zidane         Today:  0 All:   10     -9

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
■コミットコメント
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
コミットしてみました

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
■詳細情報: [U:修正，A:追加，D:削除]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
--------------------------------------------------------
U /opt/svn/naoki/boost.js
--------------------------------------------------------

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
■コミット情報
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
リポジトリ: /opt/svn/naoki
リビジョン: 44
更新者    : なおき                                      
更新日時  : 2011-06-05 23:09:25 +0900 (Sun, 05 Jun 2011)  

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
■コミットランキング
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
1: naoki          Today:  2 All:   19:######################################
2: zidane         Today:  0 All:   10:##################
3: zora           Today:  0 All:    5:#########
4: baggio         Today:  0 All:    4:########

now commit : naoki


